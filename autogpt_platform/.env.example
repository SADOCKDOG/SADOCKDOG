############
# SECURITY WARNING: This is a template file
# 1. Copy this file to .env
# 2. Replace ALL placeholder values with your own secure values
# 3. NEVER commit .env to version control
############

############
# Secrets - CHANGE ALL OF THESE BEFORE PRODUCTION
############

# Generate strong passwords using: openssl rand -base64 32
POSTGRES_PASSWORD=CHANGE_ME_TO_STRONG_PASSWORD_MIN_32_CHARS
JWT_SECRET=CHANGE_ME_TO_STRONG_JWT_SECRET_MIN_32_CHARS

# These are Supabase demo keys - OK for local dev, MUST change for production
ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyAgCiAgICAicm9sZSI6ICJhbm9uIiwKICAgICJpc3MiOiAic3VwYWJhc2UtZGVtbyIsCiAgICAiaWF0IjogMTY0MTc2OTIwMCwKICAgICJleHAiOiAxNzk5NTM1NjAwCn0.dc_X5iR_VP_qT0zsiyj_I_OZ2T9FtRU2BBNWN8Bu4GE
SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyAgCiAgICAicm9sZSI6ICJzZXJ2aWNlX3JvbGUiLAogICAgImlzcyI6ICJzdXBhYmFzZS1kZW1vIiwKICAgICJpYXQiOiAxNjQxNzY5MjAwLAogICAgImV4cCI6IDE3OTk1MzU2MDAKfQ.DaYlNEoUrrEn2Ig7tqibS-PHK5vgusbcbo7X36XVt4Q

DASHBOARD_USERNAME=CHANGE_ME
DASHBOARD_PASSWORD=CHANGE_ME_TO_STRONG_PASSWORD

# Generate using: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
SECRET_KEY_BASE=CHANGE_ME_TO_RANDOM_BASE64_STRING
VAULT_ENC_KEY=CHANGE_ME_MIN_32_CHARS

############
# Database Configuration
############

POSTGRES_HOST=db
POSTGRES_DB=postgres
POSTGRES_PORT=5432

############
# Supavisor -- Database pooler
############
POOLER_PROXY_PORT_TRANSACTION=6543
POOLER_DEFAULT_POOL_SIZE=20
POOLER_MAX_CLIENT_CONN=100
POOLER_TENANT_ID=CHANGE_ME

############
# API Proxy - Kong
############

KONG_HTTP_PORT=8000
KONG_HTTPS_PORT=8443

############
# API - PostgREST
############

PGRST_DB_SCHEMAS=public,storage,graphql_public

############
# Auth - GoTrue
############

SITE_URL=http://localhost:3000
ADDITIONAL_REDIRECT_URLS=
JWT_EXPIRY=3600
DISABLE_SIGNUP=false
API_EXTERNAL_URL=http://localhost:8000

## Mailer Config
MAILER_URLPATHS_CONFIRMATION="/auth/v1/verify"
MAILER_URLPATHS_INVITE="/auth/v1/verify"
MAILER_URLPATHS_RECOVERY="/auth/v1/verify"
MAILER_URLPATHS_EMAIL_CHANGE="/auth/v1/verify"

## Email auth
ENABLE_EMAIL_SIGNUP=true
ENABLE_EMAIL_AUTOCONFIRM=false
SMTP_ADMIN_EMAIL=admin@example.com

# =============================================================================
# SMTP Configuration
# =============================================================================
# For local development, use the default Supabase mail service
# For production, configure a production-grade SMTP provider
#
# --- Local Development (Default) ---
SMTP_HOST=supabase-mail
SMTP_PORT=2500
SMTP_USER=local_user
SMTP_PASS=local_pass
SMTP_SENDER_NAME=AutoGPT Platform Dev

# --- Production Options ---
# Choose ONE of the following providers and uncomment the relevant section:
#
# Option 1: SendGrid (Recommended for high volume)
# SMTP_HOST=smtp.sendgrid.net
# SMTP_PORT=587
# SMTP_USER=apikey
# SMTP_PASS=SG.your-sendgrid-api-key
# SMTP_SENDER_NAME=AutoGPT Platform
#
# Option 2: Mailgun
# SMTP_HOST=smtp.mailgun.org
# SMTP_PORT=587
# SMTP_USER=postmaster@your-domain.mailgun.org
# SMTP_PASS=your-mailgun-smtp-password
# SMTP_SENDER_NAME=AutoGPT Platform
#
# Option 3: AWS SES (Simple Email Service)
# SMTP_HOST=email-smtp.us-east-1.amazonaws.com
# SMTP_PORT=587
# SMTP_USER=your-aws-smtp-username
# SMTP_PASS=your-aws-smtp-password
# SMTP_SENDER_NAME=AutoGPT Platform
#
# Option 4: Gmail (Not recommended for production)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASS=your-app-specific-password
# SMTP_SENDER_NAME=AutoGPT Platform
#
# Option 5: Office 365 / Outlook
# SMTP_HOST=smtp.office365.com
# SMTP_PORT=587
# SMTP_USER=your-email@yourdomain.com
# SMTP_PASS=your-password
# SMTP_SENDER_NAME=AutoGPT Platform
#
# NOTES:
# - Always use TLS/SSL encryption in production (port 587 or 465)
# - Configure SPF, DKIM, and DMARC DNS records for better deliverability
# - Monitor bounce rates and reputation with your provider's dashboard
# - Rotate SMTP credentials every 90 days (see SECURITY.md)
# - Never commit real SMTP credentials to version control
# - Use GitHub Secrets for CI/CD deployments
#
# Troubleshooting:
# - Port 25: Often blocked by ISPs, not recommended
# - Port 587: STARTTLS, recommended for most providers
# - Port 465: SSL/TLS, alternative to 587
# - Test connection: `telnet smtp.example.com 587`
# - Check logs: `docker logs autogpt-supabase-auth-1`

ENABLE_ANONYMOUS_USERS=false

## Phone auth
ENABLE_PHONE_SIGNUP=true
ENABLE_PHONE_AUTOCONFIRM=true

# =============================================================================
# Feature Flags - LaunchDarkly
# =============================================================================
# LaunchDarkly provides feature flag management for gradual rollouts, A/B testing,
# and runtime configuration changes without deployments.
#
# --- Local Development (Disabled by default) ---
# LAUNCH_DARKLY_SDK_KEY=
#
# --- Production Setup ---
# LAUNCH_DARKLY_SDK_KEY=sdk-YOUR-SERVER-SIDE-SDK-KEY
#
# Configuration:
# 1. Create account at https://launchdarkly.com
# 2. Create a new project and environment (Production, Staging, Development)
# 3. Copy the SDK key from Settings > Environments > [Environment] > SDK Key
# 4. Add to backend environment variables
# 5. Configure flags in LaunchDarkly dashboard
#
# Current Feature Flags (see backend/util/feature_flag.py):
# - AutoMod: Automated content moderation
# - ai-agent-execution-summary: AI activity status tracking
# - beta-blocks: Enable beta/experimental block types
# - agent-activity: Agent activity monitoring
# - enable-platform-payment: Enable payment features in production
#
# Usage in Backend:
#   from backend.util.feature_flag import Flag, get_flag_bool
#   
#   if get_flag_bool(Flag.ENABLE_PLATFORM_PAYMENT, user_id, default=False):
#       # Feature enabled
#
# IMPORTANT:
# - Never commit real SDK keys to version control
# - Use separate environments (Development, Staging, Production)
# - Default values are used when LaunchDarkly is unavailable
# - Monitor flag usage in LaunchDarkly dashboard
# - Rotate SDK keys if compromised
#
# Troubleshooting:
# - Check logs: "LaunchDarkly client initialized successfully"
# - Verify SDK key format: starts with "sdk-"
# - Test flag evaluation in LaunchDarkly debugger
# - Ensure user context includes user_id
# - Check network connectivity to LaunchDarkly API

############
# Studio - Dashboard
############

STUDIO_DEFAULT_ORGANIZATION=Default Organization
STUDIO_DEFAULT_PROJECT=Default Project
STUDIO_PORT=3000
SUPABASE_PUBLIC_URL=http://localhost:8000

# Enable webp support
IMGPROXY_ENABLE_WEBP_DETECTION=true

# Add your OpenAI API key here (optional, for SQL Editor Assistant)
OPENAI_API_KEY=

############
# Functions
############
FUNCTIONS_VERIFY_JWT=false

############
# Logs - Logflare
############

LOGFLARE_LOGGER_BACKEND_API_KEY=CHANGE_ME_IF_USING_LOGFLARE
LOGFLARE_API_KEY=CHANGE_ME_IF_USING_LOGFLARE

# Docker socket location
DOCKER_SOCKET_LOCATION=/var/run/docker.sock

# Google Cloud Project (optional)
GOOGLE_PROJECT_ID=
GOOGLE_PROJECT_NUMBER=
